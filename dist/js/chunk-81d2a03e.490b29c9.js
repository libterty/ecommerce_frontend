(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-81d2a03e"],{"144d":function(e,t,n){},"37de":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{staticClass:"py-5"},[n("h1",[e._v("折價卷資訊")]),n("AdminNav"),e.isShow?n("b-container",[n("AdminCoupons",{attrs:{initCoupons:e.initCoupons},on:{"after-submit-create":e.afterSubmitCreate,"after-submit-edit":e.afterSubmitEdit,"after-submit-delete":e.afterSubmitDelete}})],1):e._e()],1)},i=[],r=(n("d3b7"),n("96cf"),n("e04c")),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"coupon-form"},[e.isShowCreate?n("b-form",{on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.submitNewCoupon(t)}}},[n("b-form-group",{attrs:{"label-cols-sm":"3",label:"折價卷名稱:","label-align-sm":"center","label-for":"newCoupon-couponCode-input"}},[n("b-form-input",{attrs:{id:"newCoupon-couponCode-input",state:e.newCoupon.couponCode.length>0,type:"text",name:"newCoupon-couponCode-input",required:""},model:{value:e.newCoupon.couponCode,callback:function(t){e.$set(e.newCoupon,"couponCode",t)},expression:"newCoupon.couponCode"}})],1),n("b-form-group",{attrs:{"label-cols-sm":"3",label:"有效次數:","label-align-sm":"center","label-for":"newCoupon-limitedUsage-input"}},[n("b-form-input",{attrs:{id:"newCoupon-limitedUsage-input",state:e.newCoupon.limitedUsage>0,type:"number",name:"newCoupon-limitedUsage-input",min:"1",required:""},model:{value:e.newCoupon.limitedUsage,callback:function(t){e.$set(e.newCoupon,"limitedUsage",t)},expression:"newCoupon.limitedUsage"}})],1),n("b-form-group",{attrs:{"label-cols-sm":"3",label:"有效期限:","label-align-sm":"center","label-for":"newCoupon-expireDate-input"}},[n("b-form-input",{attrs:{id:"newCoupon-expireDate-input",type:"date",name:"newCoupon-expireDate-input",required:""},model:{value:e.newCoupon.expireDate,callback:function(t){e.$set(e.newCoupon,"expireDate",t)},expression:"newCoupon.expireDate"}})],1),n("b-form-group",{attrs:{"label-cols-sm":"3",label:"折扣率:","label-align-sm":"center","label-for":"newCoupon-percent-input"}},[n("b-form-input",{attrs:{id:"newCoupon-percent-input",state:e.newCoupon.percent>0,type:"number",name:"newCoupon-percent-input",min:"5",max:"95",required:""},model:{value:e.newCoupon.percent,callback:function(t){e.$set(e.newCoupon,"percent",t)},expression:"newCoupon.percent"}})],1),n("b-button-group",[n("b-button",{attrs:{type:"submit",variant:"success",size:"lg"}},[e._v("Submit")]),n("b-button",{staticStyle:{"margin-left":"0.25rem"},attrs:{type:"button",variant:"info",size:"lg"},on:{click:function(t){e.isShowCreate=!1}}},[e._v("Close")])],1)],1):e._e(),e.isShowEdit?n("b-form",{on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.submitEditCoupon(t)}}},[n("b-form-group",{attrs:{"label-cols-sm":"3",label:"折價卷名稱:","label-align-sm":"center","label-for":"editCoupon-couponCode-input"}},[n("b-form-input",{attrs:{id:"editCoupon-couponCode-input",state:e.editCoupon.couponCode.length>0,type:"text",placeholder:e.editCoupon.couponCode,name:"editCoupon-couponCode-input",required:""},model:{value:e.editCoupon.couponCode,callback:function(t){e.$set(e.editCoupon,"couponCode",t)},expression:"editCoupon.couponCode"}})],1),n("b-form-group",{attrs:{"label-cols-sm":"3",label:"有效次數:","label-align-sm":"center","label-for":"editCoupon-limitedUsage-input"}},[n("b-form-input",{attrs:{id:"editCoupon-limitedUsage-input",state:e.editCoupon.limitedUsage>0,type:"number",name:"editCoupon-limitedUsage-input",min:"1",required:""},model:{value:e.editCoupon.limitedUsage,callback:function(t){e.$set(e.editCoupon,"limitedUsage",t)},expression:"editCoupon.limitedUsage"}})],1),n("b-form-group",{attrs:{"label-cols-sm":"3",label:"有效期限:","label-align-sm":"center","label-for":"editCoupon-expireDate-input"}},[n("b-form-input",{attrs:{id:"editCoupon-expireDate-input",type:"date",name:"editCoupon-expireDate-input",required:""},model:{value:e.editCoupon.expireDate,callback:function(t){e.$set(e.editCoupon,"expireDate",t)},expression:"editCoupon.expireDate"}})],1),n("b-form-group",{attrs:{"label-cols-sm":"3",label:"折扣率:","label-align-sm":"center","label-for":"editCoupon-percent-input"}},[n("b-form-input",{attrs:{id:"editCoupon-percent-input",state:e.editCoupon.percent>0,type:"number",name:"editCoupon-percent-input",min:"5",max:"95",required:""},model:{value:e.editCoupon.percent,callback:function(t){e.$set(e.editCoupon,"percent",t)},expression:"editCoupon.percent"}})],1),n("b-button-group",[n("b-button",{attrs:{type:"submit",variant:"success",size:"lg"}},[e._v("Submit")]),n("b-button",{staticStyle:{"margin-left":"0.25rem"},attrs:{type:"button",variant:"info",size:"lg"},on:{click:function(t){e.isShowEdit=!1}}},[e._v("Close")])],1)],1):e._e()],1),n("b-table-simple",{attrs:{hover:"",small:"","caption-top":"",responsive:""}},[n("b-thead",{attrs:{"head-variant":"dark"}},[n("b-tr",[n("b-th",{attrs:{colspan:"5"}},[e._v("基本資訊")]),n("b-th",{attrs:{colspan:"2"}},[e._v("操作")])],1),n("b-tr",[n("b-th",{attrs:{colspan:"1"}},[e._v("#")]),n("b-th",{attrs:{colspan:"1"}},[e._v("折價卷名稱")]),n("b-th",{attrs:{colspan:"1"}},[e._v("有效日期")]),n("b-th",{attrs:{colspan:"1"}},[e._v("剩餘有效次數")]),n("b-th",{attrs:{colspan:"1"}},[e._v("折扣率 (％)")]),n("b-th",{attrs:{colspan:"1"}},[e._v("修改")]),n("b-th",{attrs:{colspan:"1"}},[e._v("刪除")])],1)],1),n("b-tbody",e._l(e.initCoupons,(function(t){return n("b-tr",{key:t.id},[n("b-td",{staticClass:"text-center"},[e._v(e._s(t.id))]),n("b-td",{staticClass:"text-center"},[e._v(e._s(t.coupon_code))]),n("b-td",{staticClass:"text-center"},[e._v(e._s(e._f("convetTime")(t.expire_date)))]),n("b-td",{staticClass:"text-center"},[e._v(e._s(e._f("isUsage")(t.limited_usage)))]),n("b-td",{staticClass:"text-center"},[e._v(e._s(e._f("isPercentage")(t.percent)))]),n("b-td",{staticClass:"text-center"},[n("b-button",{attrs:{type:"button",variant:"warning",size:"sm"},on:{click:function(n){return e.clickEdit(t.id,t.coupon_code,t.limited_usage,t.expire_date,t.percent)}}},[e._v("修改")])],1),n("b-td",{staticClass:"text-center"},[n("b-button",{attrs:{type:"button",variant:"danger",size:"sm"},on:{click:function(n){return e.clickDelete(t.id)}}},[e._v("刪除")])],1)],1)})),1)],1),n("b-button",{on:{click:function(t){e.isShowCreate=!0}}},[e._v("Create New Coupon")])],1)},s=[],u=(n("1276"),n("2fa3")),p={props:{initCoupons:{type:Array}},filters:{isUsage:function(e){return e||"無限制"},isPercentage:function(e){return e?e+"%":"350元"},convetTime:function(e){if(e)return e.split("T")[0]}},data:function(){return{isShowCreate:!1,isShowEdit:!1,newCoupon:{couponCode:"",limitedUsage:0,expireDate:"",percent:0},editCouponId:0,editCoupon:{couponCode:"",limitedUsage:0,expireDate:"",percent:0}}},methods:{clickEdit:function(e,t,n,o,i){this.editCouponId=e,this.editCoupon.couponCode=t,this.editCoupon.limitedUsage=n,this.editCoupon.expireDate=o,this.editCoupon.percent=i,this.isShowEdit=!0},checkDate:function(e){var t=(new Date).getFullYear(),n=(new Date).getMonth()+1,o=(new Date).getDate(),i=new Date(t+"-"+n+"-"+o).getTime(),r=new Date(e).getTime();return!(r<i)},submitNewCoupon:function(){if(this.newCoupon.couponCode.length<1)return u["a"].fire({icon:"error",title:"Wrong Input Detected"});if(this.newCoupon.limitedUsage<1)return u["a"].fire({icon:"error",title:"Wrong Input Detected"});if(this.newCoupon.percent<5||this.newCoupon.percent>95)return u["a"].fire({icon:"error",title:"Wrong Input Detected"});if(!this.checkDate(this.newCoupon.expireDate))return u["a"].fire({icon:"error",title:"Wrong Limited Time selected"});var e=JSON.stringify(this.newCoupon);this.$emit("after-submit-create",e),this.isShowCreate=!1},submitEditCoupon:function(){if(this.editCoupon.couponCode.length<1)return u["a"].fire({icon:"error",title:"Wrong Input Detected"});if(this.editCoupon.limitedUsage<1)return u["a"].fire({icon:"error",title:"Wrong Input Detected"});if(this.editCoupon.percent<5||this.editCoupon.percent>95)return u["a"].fire({icon:"error",title:"Wrong Input Detected"});if(!this.checkDate(this.editCoupon.expireDate))return u["a"].fire({icon:"error",title:"Wrong Limited Time selected"});var e=JSON.stringify(this.editCoupon);this.$emit("after-submit-edit",this.editCouponId,e),this.isShowEdit=!1},clickDelete:function(e){this.$emit("after-submit-delete",e)}},watch:{initCoupons:function(e){this.initCoupons=e}}},c=p,l=(n("7e9a"),n("2877")),d=Object(l["a"])(c,a,s,!1,null,"4ce1b923",null),m=d.exports,b=n("365c"),C=new b["a"],f={name:"admin-coupons",components:{AdminNav:r["a"],AdminCoupons:m},data:function(){return{isShow:!1,initCoupons:[]}},created:function(){var e;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,regeneratorRuntime.awrap(C.getAdminCoupons());case 3:e=t.sent,"success"===e.status&&(this.initCoupons=e.coupons,this.isShow=!0),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),u["a"].fire({icon:"warning",title:"Fetch Coupon error"});case 10:case"end":return t.stop()}}),null,this,[[0,7]])},methods:{afterSubmitCreate:function(e){var t,n;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,regeneratorRuntime.awrap(C.postAdminCoupon(e));case 3:if(t=o.sent,"success"!==t.status){o.next=11;break}return o.next=7,regeneratorRuntime.awrap(C.getAdminCoupons());case 7:n=o.sent,this.initCoupons=n.coupons,this.isShow=!0,u["a"].fire({title:"Created!",text:"Your Coupon has been Created.",icon:"success"});case 11:o.next=16;break;case 13:o.prev=13,o.t0=o["catch"](0),u["a"].fire({icon:"warning",title:o.t0.message});case 16:case"end":return o.stop()}}),null,this,[[0,13]])},afterSubmitEdit:function(e,t){var n,o;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,regeneratorRuntime.awrap(C.putAdminCoupon(e,t));case 3:if(n=i.sent,"success"!==n.status){i.next=11;break}return i.next=7,regeneratorRuntime.awrap(C.getAdminCoupons());case 7:o=i.sent,this.initCoupons=o.coupons,this.isShow=!0,u["a"].fire({title:"Edited!",text:"Your Coupon has been Edited.",icon:"success"});case 11:i.next=16;break;case 13:i.prev=13,i.t0=i["catch"](0),u["a"].fire({icon:"warning",title:i.t0.message});case 16:case"end":return i.stop()}}),null,this,[[0,13]])},afterSubmitDelete:function(e){var t,n;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,regeneratorRuntime.awrap(C.deleteAdminCoupon(e));case 3:if(t=o.sent,"success"!==t.status){o.next=11;break}return o.next=7,regeneratorRuntime.awrap(C.getAdminCoupons());case 7:n=o.sent,this.initCoupons=n.coupons,this.isShow=!0,u["a"].fire({title:"Deleted!",text:"Your Coupon has been deleted.",icon:"success"});case 11:o.next=16;break;case 13:o.prev=13,o.t0=o["catch"](0),u["a"].fire({icon:"warning",title:o.t0.message});case 16:case"end":return o.stop()}}),null,this,[[0,13]])}}},h=f,g=Object(l["a"])(h,o,i,!1,null,null,null);t["default"]=g.exports},"7e9a":function(e,t,n){"use strict";var o=n("144d"),i=n.n(o);i.a},e04c:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-nav",{attrs:{tabs:"",justified:""}},e._l(e.tabs,(function(t){return n("b-nav-item",{key:t.id,attrs:{href:t.path}},[e._v(" "+e._s(t.title)+" ")])})),1)},i=[],r=n("e1bd"),a=n.n(r),s={data:function(){return{tabs:[{id:a()(5),title:"建立新的產品",path:"/admin/products/create"},{id:a()(5),title:"產品資訊",path:"/admin/products"},{id:a()(5),title:"折價卷資訊",path:"/admin/coupons"},{id:a()(5),title:"銷售資訊",path:"/admin/payments"},{id:a()(5),title:"呆帳管理",path:"/admin/orders"},{id:a()(5),title:"系統日誌",path:"/admin/logs"},{id:a()(5),title:"前往前台",path:"/"}]}}},u=s,p=n("2877"),c=Object(p["a"])(u,o,i,!1,null,null,null);t["a"]=c.exports},e1bd:function(e,t,n){var o=self.crypto||self.msCrypto,i="QLUint8ARdomValuesObj0h6345-79BCrypgJzHKTNYDSMkXPZ_FfG1WcqvwxEI2";e.exports=function(e){e=e||21;var t="",n=o.getRandomValues(new Uint8Array(e));while(e--)t+=i[63&n[e]];return t}}}]);
//# sourceMappingURL=chunk-81d2a03e.490b29c9.js.map